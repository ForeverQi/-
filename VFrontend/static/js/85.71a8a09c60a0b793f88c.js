webpackJsonp([85],{nPyD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("RJSr");var s=n("dT7Q"),i=n("0IQH"),a=n("b9vL"),c=n("mUeO"),o={name:"classManage",data:function(){return{changeDialog:!1,dialogAction:!1,loading:!1,curItem:{id:0,name:"",order_sort:0},list:[],listChange:!1}},created:function(){this.$util.app.Shop.Refresh(!1,0),this.getClassListData()},methods:{getClassListData:function(){var t=this;t.loading=!0,Object(c.e)({}).then(function(e){t.loading=!1,e.list&&e.list.length&&e.list.forEach(function(e){e.up=0,e.down=0,t.list.push(e)})})},changeItemFun:function(t,e,n){switch(e&&(this.curItem.id=e.id,this.curItem.name=e.name,this.curItem.order_sort=e.order_sort,this.curItem.index=n),t){case"del":this.deleteClassify(e,n);break;case"edit":case"add":"add"==t&&(this.curItem.id=0,this.curItem.name="",this.curItem.order_sort=0),this.changeDialog=!0,this.dialogAction=t}},enderChangeName:function(){},deleteClassify:function(t,e){var n=this;s.a.confirm({className:"video-dialog-alert",message:"确定要删除该分类吗？",confirmButtonColor:"#FF9900"}).then(function(){Object(c.c)({type:"del",id:t.id}).then(function(t){n.list.splice(e,1),i.a.Msg({message:"删除成功"})})}).catch(function(){})},closeFun:function(t,e){var n=this;switch(t){case"cancel":e();break;case"confirm":var s=!1,a=n.curItem;if(a.name.gblen()>16&&(s="分类名称最多支持8个汉字或16个字符"),a.name.gblen()<1&&(s="分类名称不能为空"),s)return i.a.Msg({message:s}),void e(!1);Object(c.c)({type:n.dialogAction,id:n.curItem.id,name:n.curItem.name}).then(function(t){i.a.Msg({message:"add"==n.dialogAction?"添加成功":"修改成功"}),"add"==n.dialogAction?(n.list.splice(0,n.list.length),n.getClassListData()):n.list[n.curItem.index].name=n.curItem.name,e()})}},changeSort:function(t,e,n){var s=this,i=null,a=function(t,e,n){t[e]=t.splice(n,1,t[e])[0]};switch(s.listChange=!0,t){case"up":i=s.list[n-1],e.up=1,i.down=1,setTimeout(function(){a(s.list,n,n-1),e.up=0,i.down=0},300);break;case"down":i=s.list[n+1],e.down=1,i.up=1,setTimeout(function(){a(s.list,n,n+1),e.down=0,i.up=0},300)}},saveChange:function(){var t=this,e={};t.list.forEach(function(t,n){e[n]=t.id}),Object(c.d)({ids:e}).then(function(e){i.a.Msg({message:"保存成功"}),t.listChange=!1})}},components:{PageHead:a.a},beforeDestroy:function(){this.$util.app.Shop.Refresh(!0,0)}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"C-M-P"},[n("PageHead",{attrs:{title:"分类管理"}},[[n("div",{staticClass:"btn-box"},[t.listChange?t._e():n("span",{staticClass:"add-btn",on:{click:function(e){return t.changeItemFun("add")}}},[t._v("添加分类")]),t._v(" "),t.listChange?n("button",{staticClass:"orange-btn",on:{click:t.saveChange}},[t._v("保存")]):t._e()])]],2),t._v(" "),n("div",{staticClass:"classify-lsit-wrap"},[t.loading?t._e():n("dl",[n("dd",[t.list.length?n("ul",{ref:"classifyList",staticClass:"classify-list"},[t._l(t.list,function(e,s){return[n("li",{key:e.id,class:{moveUp:e.up,moveDown:e.down}},[n("div",{staticClass:"li-inner"},[n("span",{staticClass:"key-word"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"btn-box"},[n("i",{class:[{hidden:0===s},"sjzs-icon","s-icon-up-1"],on:{click:function(n){return t.changeSort("up",e,s)}}}),t._v(" "),n("i",{class:[{hidden:s==t.list.length-1},"sjzs-icon","s-icon-down-1"],on:{click:function(n){return t.changeSort("down",e,s)}}}),t._v(" "),n("i",{staticClass:"sjzs-icon s-icon-edit-1",on:{click:function(n){return t.changeItemFun("edit",e,s)}}}),t._v(" "),n("i",{staticClass:"sjzs-icon s-icon-cross-1",on:{click:function(n){return t.changeItemFun("del",e,s)}}})])])])]})],2):t._e(),t._v(" "),t.list.length?t._e():n("span",{staticClass:"no-data-text"},[t._v("没有相关数据")])])]),t._v(" "),t.loading?n("span",{staticClass:"loading-icon"}):t._e()]),t._v(" "),n("van-dialog",{attrs:{title:"请输入分类名称","before-close":t.closeFun,"show-cancel-button":"","confirm-button-color":"#FF9900"},on:{confirm:t.enderChangeName},model:{value:t.changeDialog,callback:function(e){t.changeDialog=e},expression:"changeDialog"}},[n("div",{staticClass:"change-classify-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.curItem.name,expression:"curItem.name"}],attrs:{type:"text",placeholder:"最多支持8个汉字"},domProps:{value:t.curItem.name},on:{input:function(e){e.target.composing||t.$set(t.curItem,"name",e.target.value)}}})])])],1)},staticRenderFns:[]};var r=n("C7Lr")(o,l,!1,function(t){n("v/cu")},null,null);e.default=r.exports},"v/cu":function(t,e){}});
//# sourceMappingURL=85.71a8a09c60a0b793f88c.js.map